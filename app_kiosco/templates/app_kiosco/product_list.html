{% extends 'app_kiosco/base.html' %}
{% block title %}Productos{% endblock %}
{% block content %}
<h2>Listado de productos</h2>

<p><a href="{% url 'product_export_csv' %}">Exportar a CSV</a></p>

<table border="1">
  <tr>
    <th>Nombre</th><th>Código</th><th>Categoría</th><th>Proveedor</th><th>Precio</th><th>Stock</th>
  </tr>
  {% for p in products %}
  <tr>
    <td>
      {{ p.name }}  
      <div>
        <a href="{% url 'product_update' p.pk %}">Editar</a> ·
        <a href="{% url 'product_delete' p.pk %}">Borrar</a>
      </div>
    </td>
    <td>{{ p.barcode }}</td>
    <td>{{ p.category }}</td>
    <td>{{ p.supplier }}</td>
    <td>{{ p.sale_price }}</td>
    <td>
      <strong>{{ p.stock }}</strong>
      {% if p.stock <= 3 %}<span style="color:red"> (bajo)</span>{% endif %}
    </td>
  </tr>
  {% endfor %}
</table>

{% if is_paginated %}
  <nav>
    {% if page_obj.has_previous %}
      <a href="?page={{ page_obj.previous_page_number }}">Anterior</a>
    {% endif %}
    <span>Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}">Siguiente</a>
    {% endif %}
  </nav>
{% endif %}
{% endblock %}
